<!doctype html>
<html lang="ko" class="h-full">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>YouTube Analyzer</title>

  <!-- Tailwind CDN (no build, no deps) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- SheetJS for XLSX export -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.19.3/dist/xlsx.full.min.js"></script>

  <style>
    :root{
      --bg: 10 12 16;
      --panel: 17 22 30;
      --panel2: 22 28 38;
      --text: 235 237 242;
      --muted: 165 174 189;
      --border: 44 54 72;
      --accent: 99 102 241;
      --danger: 239 68 68;
      --ok: 34 197 94;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    [data-theme="light"]{
      --bg: 247 248 251;
      --panel: 255 255 255;
      --panel2: 249 250 251;
      --text: 17 24 39;
      --muted: 107 114 128;
      --border: 226 232 240;
      --shadow: 0 10px 24px rgba(15,23,42,.10);
    }
    html, body { height: 100%; background: rgb(var(--bg)); color: rgb(var(--text)); }
    .panel { background: rgb(var(--panel)); border: 1px solid rgb(var(--border)); box-shadow: var(--shadow); }
    .panel2 { background: rgb(var(--panel2)); border: 1px solid rgb(var(--border)); }
    .muted { color: rgb(var(--muted)); }
    .btn { background: rgb(var(--panel2)); border: 1px solid rgb(var(--border)); }
    .btn:hover { filter: brightness(1.08); }
    .btn-primary { background: rgb(var(--accent)); border: 0; color: white; }
    .btn-primary:hover { filter: brightness(1.06); }
    .btn-danger { background: rgb(var(--danger)); border: 0; color: white; }
    .chip { background: rgba(var(--accent), .12); border: 1px solid rgba(var(--accent), .35); color: rgb(var(--text)); }
    .input { background: rgba(255,255,255,.04); border: 1px solid rgb(var(--border)); color: rgb(var(--text)); }
    [data-theme="light"] .input { background: white; }
    .scrollbar::-webkit-scrollbar{ height:10px; width:10px; }
    .scrollbar::-webkit-scrollbar-thumb{ background: rgba(255,255,255,.12); border-radius: 999px; }
    [data-theme="light"] .scrollbar::-webkit-scrollbar-thumb{ background: rgba(15,23,42,.15); }
    .toast { position: fixed; right: 16px; bottom: 16px; z-index: 50; }
    .toast > div { background: rgb(var(--panel)); border: 1px solid rgb(var(--border)); box-shadow: var(--shadow); padding: 10px 12px; border-radius: 12px; margin-top: 8px; max-width: 380px; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .link { color: rgb(var(--text)); text-decoration: underline; text-decoration-color: rgba(var(--muted),.6); }
    .link:hover { text-decoration-color: rgba(var(--text),.9); }
    .tab-active { background: rgba(var(--accent), .20) !important; border-color: rgba(var(--accent), .45) !important; }
    .pill { background: rgba(255,255,255,.06); border: 1px solid rgb(var(--border)); border-radius: 999px; padding: 2px 10px; font-size: 12px; }
    [data-theme="light"] .pill { background: rgba(15,23,42,.04); }
    .modal-backdrop{ position: fixed; inset:0; background: rgba(0,0,0,.55); display:none; z-index: 60; }
    .modal{ position: fixed; top: 50%; left: 50%; transform: translate(-50%,-50%); width: min(920px, 92vw); max-height: 86vh; overflow:auto; display:none; z-index: 70; }
  </style>
</head>

<body class="h-full">
<div class="max-w-[1200px] mx-auto px-4 py-6">
  <!-- Header -->
  <div class="flex flex-col gap-2 md:flex-row md:items-start md:justify-between">
    <div>
      <div class="flex items-center gap-3">
        <h1 class="text-2xl font-bold tracking-tight">YouTube Analyzer</h1>
        <span class="chip text-xs px-2 py-1 rounded-full">데이터 수집·정리 + GPT용 프롬프트/분석팩 생성</span>
      </div>
      <p class="muted text-sm mt-1">앱이 결론/인사이트를 자동 작성하지 않습니다. <span class="font-semibold">데이터와 분석팩/프롬프트</span>만 제공합니다.</p>
      <p id="fileModeHint" class="muted text-xs mt-1 hidden">로컬(file://)로 열려 있습니다. <span class="font-semibold">API 도메인</span>을 입력해야 채널 호출이 됩니다.</p>
    </div>
    <div class="flex items-center gap-2 mt-2 md:mt-0">
      <button id="btnRoot" class="btn px-3 py-2 rounded-lg text-sm">루트로</button>
      <button id="btnResetAll" class="btn px-3 py-2 rounded-lg text-sm">초기화</button>
      <button id="btnTheme" class="btn px-3 py-2 rounded-lg text-sm">라이트</button>
    </div>
  </div>

  <!-- API Base -->
  <div class="panel rounded-2xl p-4 mt-4">
    <div class="flex flex-col lg:flex-row gap-3 lg:items-center lg:justify-between">
      <div class="flex-1">
        <div class="flex items-center gap-2">
          <div class="text-sm font-semibold">API 도메인</div>
          <span class="muted text-xs">(로컬에서 열 때 필수)</span>
        </div>
        <div class="flex gap-2 mt-2">
          <input id="apiBase" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="예: https://your-project.vercel.app" />
          <button id="btnSaveApiBase" class="btn px-3 py-2 rounded-lg text-sm whitespace-nowrap">저장</button>
          <button id="btnTestApiBase" class="btn px-3 py-2 rounded-lg text-sm whitespace-nowrap">연결 테스트</button>
        </div>
        <div id="apiTestStatus" class="muted text-xs mt-2 hidden"></div>
        <div class="muted text-xs mt-2">
          기본값: 배포에서 열면 자동으로 현재 도메인을 사용합니다. 로컬(file://)이면 위 입력값을 사용합니다.
        </div>
      </div>
      <div class="panel2 rounded-2xl p-3 min-w-[320px]">
        <div class="text-sm font-semibold">분석 모드</div>
        <div class="flex gap-3 mt-2 flex-wrap">
          <label class="flex items-center gap-2 text-sm"><input type="radio" name="mode" value="compare" checked> 비교(채널 A vs B)</label>
          <label class="flex items-center gap-2 text-sm"><input type="radio" name="mode" value="single"> 단일(채널 A만)</label>
        </div>
        <div class="muted text-xs mt-2">* GPT 프롬프트/분석팩의 mode(my/bench/compare)는 2번 탭에서 선택</div>
      </div>
    </div>
  </div>

  <!-- Inputs A/B -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mt-4">
    <!-- A -->
    <div class="panel rounded-2xl p-4">
      <div class="flex items-start justify-between gap-3">
        <div>
          <div class="text-sm font-semibold">채널 A (내 채널)</div>
          <div class="muted text-xs mt-1">URL / @handle / 채널ID(UC...) 입력</div>
        </div>
        <span id="badgeA" class="chip text-xs px-2 py-1 rounded-full">대기</span>
      </div>
      <div class="flex gap-2 mt-3">
        <input id="inputA" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="URL / @handle / 채널ID(UC...)" />
        <button id="btnLoadA" class="btn-primary px-4 py-2 rounded-lg text-sm font-semibold">불러오기</button>
      </div>

      <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mt-3">
        <div>
          <div class="muted text-xs">최근 N개</div>
          <select id="maxA" class="input w-full px-3 py-2 rounded-lg text-sm mt-1">
            <option value="">선택 안함(기본 50)</option>
            <option value="ALL">전체(가능한 만큼·상한 500)</option>
            <option value="CUSTOM">직접입력</option>
            <option value="10">10</option>
            <option value="25">25</option>
            <option value="50" selected>50</option>
            <option value="100">100</option>
            <option value="200">200</option>
            <option value="300">300</option>
            <option value="500">500</option>
</select>
          <div id="maxCustomWrapA" class="mt-2 hidden">
            <input id="maxCustomA" type="number" min="1" max="500" step="1" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="1~500" />
            <div class="muted text-xs mt-1">※ ‘전체’는 상한 500까지 수집합니다</div>
          </div>

        </div>
        <div>
          <div class="muted text-xs">기간(일)</div>
          <select id="daysA" class="input w-full px-3 py-2 rounded-lg text-sm mt-1">
            <option value="">선택 안함(기본 30일)</option>
            <option value="0">전체(기간 제한 없음)</option>
            <option value="CUSTOM">직접입력</option>
            <option value="7">7</option>
            <option value="30" selected>30</option>
            <option value="90">90</option>
            <option value="365">365</option>
            <option value="730">730</option>
            <option value="1825">1825</option>
</select>
          <div id="daysCustomWrapA" class="mt-2 hidden">
            <input id="daysCustomA" type="number" min="0" max="3650" step="1" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="0=전체, 또는 일수 입력" />
            <div class="muted text-xs mt-1">0이면 기간 제한 없이 최신부터 상한까지 수집합니다</div>
          </div>

        </div>
        <div>
          <div class="muted text-xs">길이 분류 기준</div>
          <select id="shortsA" class="input w-full px-3 py-2 rounded-lg text-sm mt-1">
            <option value="LE:60" selected>쇼츠 ≤ 60초</option>
            <option value="LE:120">쇼츠 ≤ 120초</option>
            <option value="LE:CUSTOM">직접입력(쇼츠 이하 ≤)</option>
            <option value="GE:CUSTOM">직접입력(롱폼 이상 ≥)</option>
            <option value="OFF">전체(분류 끔)</option>
          </select>
          <div id="shortsCustomWrapA" class="mt-2 hidden">
            <div class="flex gap-2 items-center">
              <input id="shortsCustomA" type="number" min="0" step="1" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="초 입력 (예: 75)" />
              <span id="shortsCustomSuffixA" class="muted text-xs whitespace-nowrap">초</span>
            </div>
            <div id="shortsHelpA" class="muted text-xs mt-1">직접 입력 모드입니다</div>
          </div>
        </div>
        <div>
          <div class="muted text-xs">지역/언어</div>
          <select id="localeA" class="input w-full px-3 py-2 rounded-lg text-sm mt-1">
            <option value="">선택 안함(기본 KR/ko)</option>
            <option value="ALL">전체(지역/언어 제한 없음)</option>
            <option value="KR|ko" selected>KR (ko)</option>
            <option value="US|en">US (en)</option>
            <option value="JP|ja">JP (ja)</option>
            <option value="GB|en">GB (en)</option>
</select>
        </div>
      </div>

      
      <div class="mt-3">
        <div class="muted text-xs">조회수 프리필터(수집 후 적용)</div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mt-1 items-center">
          <input id="preViewsMinA" type="number" min="0" step="1" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="최소 조회수(예: 100000)" />
          <input id="preViewsMaxA" type="number" min="0" step="1" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="최대 조회수(예: 1000000)" />
          <div class="col-span-2 flex flex-wrap gap-2 items-center">
            <button class="btn btn-sm preViewsQuick" data-ch="A" data-v="100000">10만+</button>
            <button class="btn btn-sm preViewsQuick" data-ch="A" data-v="500000">50만+</button>
            <button class="btn btn-sm preViewsQuick" data-ch="A" data-v="1000000">100만+</button>
            <button id="btnPreViewsClearA" class="btn btn-sm">전체</button>
          </div>
        </div>
        <div class="muted text-xs mt-1">빈칸이면 필터 없음(선택 안함)</div>
      </div>

<div class="flex flex-col md:flex-row md:items-center gap-3 mt-3">
        <label class="flex items-center gap-2 text-sm"><input id="cacheA" type="checkbox" checked> 캐시 사용(localStorage)</label>
        <label class="flex items-center gap-2 text-sm"><input id="fallbackA" type="checkbox" checked> URL 변형 대응(search fallback 허용: 최대 100u/호출)</label>
        <label class="flex items-center gap-2 text-sm"><input id="liteA" type="checkbox"> 쿼터 절약(상세조회 최소화: 통계/길이/카테고리 제외)</label>
      </div>

      <div class="flex items-center justify-between gap-2 mt-2">
        <div class="muted text-xs">캐시 만료(시간)</div>
        <select id="ttlA" class="input px-3 py-2 rounded-lg text-sm">
          <option>1</option><option>3</option><option selected>6</option><option>12</option><option>24</option>
        </select>
      </div>
    </div>

    <!-- B -->
    <div class="panel rounded-2xl p-4">
      <div class="flex items-start justify-between gap-3">
        <div>
          <div class="text-sm font-semibold">채널 B (타 채널/벤치)</div>
          <div class="muted text-xs mt-1">URL / @handle / 채널ID(UC...) 입력</div>
        </div>
        <span id="badgeB" class="chip text-xs px-2 py-1 rounded-full">대기</span>
      </div>
      <div class="flex gap-2 mt-3">
        <input id="inputB" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="URL / @handle / 채널ID(UC...)" />
        <button id="btnLoadB" class="btn-primary px-4 py-2 rounded-lg text-sm font-semibold">불러오기</button>
      </div>

      <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mt-3">
        <div>
          <div class="muted text-xs">최근 N개</div>
          <select id="maxB" class="input w-full px-3 py-2 rounded-lg text-sm mt-1">
            <option value="">선택 안함(기본 50)</option>
            <option value="ALL">전체(가능한 만큼·상한 500)</option>
            <option value="CUSTOM">직접입력</option>
            <option value="10">10</option>
            <option value="25">25</option>
            <option value="50" selected>50</option>
            <option value="100">100</option>
            <option value="200">200</option>
            <option value="300">300</option>
            <option value="500">500</option>
</select>
          <div id="maxCustomWrapB" class="mt-2 hidden">
            <input id="maxCustomB" type="number" min="1" max="500" step="1" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="1~500" />
            <div class="muted text-xs mt-1">※ ‘전체’는 상한 500까지 수집합니다</div>
          </div>

        </div>
        <div>
          <div class="muted text-xs">기간(일)</div>
          <select id="daysB" class="input w-full px-3 py-2 rounded-lg text-sm mt-1">
            <option value="">선택 안함(기본 30일)</option>
            <option value="0">전체(기간 제한 없음)</option>
            <option value="CUSTOM">직접입력</option>
            <option value="7">7</option>
            <option value="30" selected>30</option>
            <option value="90">90</option>
            <option value="365">365</option>
            <option value="730">730</option>
            <option value="1825">1825</option>
</select>
          <div id="daysCustomWrapB" class="mt-2 hidden">
            <input id="daysCustomB" type="number" min="0" max="3650" step="1" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="0=전체, 또는 일수 입력" />
            <div class="muted text-xs mt-1">0이면 기간 제한 없이 최신부터 상한까지 수집합니다</div>
          </div>

        </div>
        <div>
          <div class="muted text-xs">길이 분류 기준</div>
          <select id="shortsB" class="input w-full px-3 py-2 rounded-lg text-sm mt-1">
            <option value="LE:60" selected>쇼츠 ≤ 60초</option>
            <option value="LE:120">쇼츠 ≤ 120초</option>
            <option value="LE:CUSTOM">직접입력(쇼츠 이하 ≤)</option>
            <option value="GE:CUSTOM">직접입력(롱폼 이상 ≥)</option>
            <option value="OFF">전체(분류 끔)</option>
          </select>
          <div id="shortsCustomWrapB" class="mt-2 hidden">
            <div class="flex gap-2 items-center">
              <input id="shortsCustomB" type="number" min="0" step="1" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="초 입력 (예: 75)" />
              <span id="shortsCustomSuffixB" class="muted text-xs whitespace-nowrap">초</span>
            </div>
            <div id="shortsHelpB" class="muted text-xs mt-1">직접 입력 모드입니다</div>
          </div>
        </div>
        <div>
          <div class="muted text-xs">지역/언어</div>
          <select id="localeB" class="input w-full px-3 py-2 rounded-lg text-sm mt-1">
            <option value="">선택 안함(기본 KR/ko)</option>
            <option value="ALL">전체(지역/언어 제한 없음)</option>
            <option value="KR|ko" selected>KR (ko)</option>
            <option value="US|en">US (en)</option>
            <option value="JP|ja">JP (ja)</option>
            <option value="GB|en">GB (en)</option>
</select>
        </div>
      </div>

      
      <div class="mt-3">
        <div class="muted text-xs">조회수 프리필터(수집 후 적용)</div>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-2 mt-1 items-center">
          <input id="preViewsMinB" type="number" min="0" step="1" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="최소 조회수(예: 100000)" />
          <input id="preViewsMaxB" type="number" min="0" step="1" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="최대 조회수(예: 1000000)" />
          <div class="col-span-2 flex flex-wrap gap-2 items-center">
            <button class="btn btn-sm preViewsQuick" data-ch="B" data-v="100000">10만+</button>
            <button class="btn btn-sm preViewsQuick" data-ch="B" data-v="500000">50만+</button>
            <button class="btn btn-sm preViewsQuick" data-ch="B" data-v="1000000">100만+</button>
            <button id="btnPreViewsClearB" class="btn btn-sm">전체</button>
          </div>
        </div>
        <div class="muted text-xs mt-1">빈칸이면 필터 없음(선택 안함)</div>
      </div>

<div class="flex flex-col md:flex-row md:items-center gap-3 mt-3">
        <label class="flex items-center gap-2 text-sm"><input id="cacheB" type="checkbox" checked> 캐시 사용(localStorage)</label>
        <label class="flex items-center gap-2 text-sm"><input id="fallbackB" type="checkbox" checked> URL 변형 대응(search fallback 허용: 최대 100u/호출)</label>
        <label class="flex items-center gap-2 text-sm"><input id="liteB" type="checkbox"> 쿼터 절약(상세조회 최소화: 통계/길이/카테고리 제외)</label>
      </div>

      <div class="flex items-center justify-between gap-2 mt-2">
        <div class="muted text-xs">캐시 만료(시간)</div>
        <select id="ttlB" class="input px-3 py-2 rounded-lg text-sm">
          <option>1</option><option>3</option><option selected>6</option><option>12</option><option>24</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Progress + Quota -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mt-4">
    <div class="panel rounded-2xl p-4">
      <div class="flex items-center justify-between">
        <div class="text-sm font-semibold">진행 상태</div>
        <div class="muted text-xs">경과: <span id="elapsed">0.0s</span></div>
      </div>
      <div class="mt-3">
        <div class="flex items-center justify-between muted text-xs">
          <div>단계: <span id="stage">대기</span></div>
          <div>진행률: <span id="progressPct">0%</span></div>
        </div>
        <div class="w-full h-2 bg-black/20 rounded-full mt-2 overflow-hidden">
          <div id="progressBar" class="h-2 rounded-full" style="width:0%; background: rgb(var(--accent));"></div>
        </div>
      </div>
      <div class="mt-3">
        <div class="muted text-xs mb-2">로그(최근 10개)</div>
        <div id="logBox" class="panel2 rounded-xl p-3 h-[110px] overflow-auto text-xs scrollbar mono"></div>
      </div>
      <div class="mt-2 muted text-xs">* likes/comments는 채널 설정에 따라 비공개면 빈값입니다</div>
      <div id="runtimeError" class="hidden mt-3 text-xs">
        <div class="text-red-300 font-semibold">오류 감지</div>
        <pre id="runtimeErrorText" class="panel2 rounded-xl p-3 mt-2 overflow-auto scrollbar mono"></pre>
      </div>
    </div>

    <div class="panel rounded-2xl p-4">
      <div class="flex items-center justify-between">
        <div class="text-sm font-semibold">쿼터(앱 추정)</div>
        <button id="btnQuotaReset" class="btn px-3 py-2 rounded-lg text-sm">오늘치 초기화</button>
      </div>
      <div class="grid grid-cols-2 gap-3 mt-3">
        <div class="panel2 rounded-xl p-3">
          <div class="muted text-xs">오늘 사용량</div>
          <div class="text-xl font-bold"><span id="quotaUsed">0</span> u</div>
        </div>
        <div class="panel2 rounded-xl p-3">
          <div class="muted text-xs">총 할당량</div>
          <div class="flex items-center gap-2 mt-1">
            <input id="quotaTotal" class="input w-full px-3 py-2 rounded-lg text-sm" type="number" value="10000"/>
            <span class="muted text-sm">u</span>
          </div>
        </div>
      </div>
      <div class="muted text-xs mt-3">
        * YouTube API 쿼터는 프로젝트 전체 기준입니다. 여기는 <span class="font-semibold">이 앱에서 호출한 추정 누적</span>입니다.
      </div>
      <div class="mt-3">
        <div class="muted text-xs mb-2">호출 로그</div>
        <div id="quotaLog" class="panel2 rounded-xl p-3 h-[110px] overflow-auto text-xs scrollbar mono"></div>
      </div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="panel rounded-2xl p-4 mt-4">
    <div class="flex items-center gap-2 flex-wrap">
      <button class="tab btn px-3 py-2 rounded-lg text-sm font-semibold tab-active" data-tab="data">1) 데이터 보기</button>
      <button class="tab btn px-3 py-2 rounded-lg text-sm" data-tab="gpt">2) GPT 분석팩/프롬프트</button>
      <button class="tab btn px-3 py-2 rounded-lg text-sm" data-tab="export">3) 내보내기</button>
      <div class="flex-1"></div>
      <div class="muted text-xs hidden md:block">행 클릭 → 상세 보기</div>
    </div>

    <!-- Tab: DATA -->
    <div id="tab-data" class="mt-4">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
        <div class="panel2 rounded-2xl p-4">
          <div class="text-sm font-semibold">채널 A 요약</div>
          <div id="summaryA" class="muted text-sm mt-2">미로드</div>
        </div>
        <div class="panel2 rounded-2xl p-4">
          <div class="text-sm font-semibold">채널 B 요약</div>
          <div id="summaryB" class="muted text-sm mt-2">미로드</div>
        </div>
      </div>

      <div class="panel2 rounded-2xl p-4 mt-4">
        <div class="flex items-center justify-between gap-3 flex-wrap">
          <div class="text-sm font-semibold">표 필터/정렬</div>
          <div class="flex items-center gap-2">
            <div class="muted text-xs">표 대상</div>
            <select id="tableTarget" class="input px-3 py-2 rounded-lg text-sm">
              <option value="A" selected>채널 A</option>
              <option value="B">채널 B</option>
              <option value="AB">A+B 합치기</option>
            </select>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mt-3">
          <div>
            <div class="muted text-xs">형태</div>
            <select id="filterType" class="input w-full px-3 py-2 rounded-lg text-sm mt-1">
              <option value="all" selected>전체</option>
              <option value="shorts">쇼츠</option>
              <option value="long">롱폼</option>
            </select>
          </div>

          <div class="md:col-span-2">
            <div class="muted text-xs">조회수(빠른 버튼)</div>
            <div class="flex flex-wrap gap-2 mt-1">
              <button class="btn px-3 py-2 rounded-lg text-sm quickViews" data-quick="100000">10만+</button>
              <button class="btn px-3 py-2 rounded-lg text-sm quickViews" data-quick="500000">50만+</button>
              <button class="btn px-3 py-2 rounded-lg text-sm quickViews" data-quick="1000000">100만+</button>
              <button id="btnQuickClear" class="btn px-3 py-2 rounded-lg text-sm">해제</button>
            </div>
          </div>

          <div>
            <div class="muted text-xs">조회수 범위(min/max)</div>
            <div class="flex gap-2 mt-1">
              <input id="viewsMin" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="min" />
              <input id="viewsMax" class="input w-full px-3 py-2 rounded-lg text-sm" placeholder="max" />
            </div>
          </div>

          <div>
            <div class="muted text-xs">기간 필터(업로드일)</div>
            <select id="filterDays" class="input w-full px-3 py-2 rounded-lg text-sm mt-1">
              <option value="all" selected>전체(수집된 범위)</option>
              <option value="7">최근 7일</option>
              <option value="30">최근 30일</option>
              <option value="90">최근 90일</option>
            </select>
          </div>

          <div>
            <div class="muted text-xs">검색(제목/해시태그)</div>
            <input id="searchText" class="input w-full px-3 py-2 rounded-lg text-sm mt-1" placeholder="예: #연애, 사연, 회사"/>
          </div>

          <div>
            <div class="muted text-xs">정렬</div>
            <select id="sortBy" class="input w-full px-3 py-2 rounded-lg text-sm mt-1">
              <option value="date_desc" selected>업로드일(최신)</option>
              <option value="views_desc">조회수(높음)</option>
              <option value="vpd_desc">조회수/일(높음)</option>
              <option value="vpd_asc">조회수/일(낮음)</option>
            </select>
          </div>
        </div>

        <div class="flex items-center gap-2 mt-4 flex-wrap">
          <button id="btnApplyFilters" class="btn-primary px-4 py-2 rounded-lg text-sm font-semibold">필터 적용</button>
          <button id="btnResetFilters" class="btn px-4 py-2 rounded-lg text-sm">필터 초기화</button>
          <button id="btnCopyTableJson" class="btn px-4 py-2 rounded-lg text-sm">현재 표(JSON) 복사</button>
          <div class="flex-1"></div>
          <div class="muted text-xs">표 요약</div>
          <div class="pill"><span id="countTotal">0</span>개</div>
          <div class="pill">필터 후 <span id="countFiltered">0</span>개</div>
        </div>
      </div>

      <div class="mt-4">
        <div class="panel2 rounded-2xl p-3 overflow-auto scrollbar">
          <table class="w-full text-sm">
            <thead class="text-xs muted">
              <tr>
                <th class="text-left py-2 px-2">#</th>
                <th class="text-left py-2 px-2">제목</th>
                <th class="text-left py-2 px-2">업로드</th>
                <th class="text-left py-2 px-2">길이</th>
                <th class="text-left py-2 px-2">형태</th>
                <th class="text-right py-2 px-2">조회수</th>
                <th class="text-right py-2 px-2">조회수/일</th>
                <th class="text-right py-2 px-2">좋아요</th>
                <th class="text-right py-2 px-2">댓글</th>
                <th class="text-left py-2 px-2">카테고리</th>
                <th class="text-left py-2 px-2">해시태그(#)</th>
              </tr>
            </thead>
            <tbody id="tableBody" class="text-sm"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Tab: GPT -->
    <div id="tab-gpt" class="mt-4 hidden">
      <div class="panel2 rounded-2xl p-4">
        <div class="flex items-center justify-between flex-wrap gap-3">
          <div>
            <div class="text-sm font-semibold">GPT 분석팩/프롬프트 생성</div>
            <div class="muted text-xs mt-1">앱은 인사이트를 자동 생성하지 않습니다. <span class="font-semibold">팩 + 지시문</span>만 생성합니다.</div>
          </div>
          <div class="flex items-center gap-3 flex-wrap">
            <label class="flex items-center gap-2 text-sm"><input type="radio" name="gptMode" value="my" checked> 내채널 분석용</label>
            <label class="flex items-center gap-2 text-sm"><input type="radio" name="gptMode" value="bench"> 타채널 벤치마킹용</label>
            <label class="flex items-center gap-2 text-sm"><input type="radio" name="gptMode" value="compare"> 내 vs 타 비교용</label>
          </div>
        </div>

        <div class="flex items-center gap-2 mt-4 flex-wrap">
          <button id="btnCopyPack" class="btn-primary px-4 py-2 rounded-lg text-sm font-semibold">분석팩 복사</button>
          <button id="btnCopyPrompt" class="btn px-4 py-2 rounded-lg text-sm">GPT 프롬프트 복사</button>
          <button id="btnCopyBoth" class="btn px-4 py-2 rounded-lg text-sm">프롬프트+분석팩 한번에 복사</button>
          <div class="flex-1"></div>
          <button id="btnRefreshGpt" class="btn px-4 py-2 rounded-lg text-sm">새로 생성</button>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mt-4">
          <div>
            <div class="muted text-xs mb-2">GPT 프롬프트(붙여넣기용)</div>
            <textarea id="gptPrompt" class="input w-full rounded-xl p-3 text-xs mono h-[320px]"></textarea>
          </div>
          <div>
            <div class="muted text-xs mb-2">분석팩(JSON)</div>
            <textarea id="gptPack" class="input w-full rounded-xl p-3 text-xs mono h-[320px]"></textarea>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab: Export -->
    <div id="tab-export" class="mt-4 hidden">
      <div class="panel2 rounded-2xl p-4">
        <div class="text-sm font-semibold">내보내기</div>
        <div class="muted text-xs mt-1">현재 필터가 적용된 표 기준으로 내보냅니다.</div>

        <div class="flex items-center gap-2 mt-4 flex-wrap">
          <button id="btnExportXlsx" class="btn-primary px-4 py-2 rounded-lg text-sm font-semibold">XLSX 내보내기</button>
          <button id="btnExportCsv" class="btn px-4 py-2 rounded-lg text-sm">CSV 내보내기</button>
          <div class="flex-1"></div>
          <div class="muted text-xs">파일명</div>
          <input id="exportName" class="input px-3 py-2 rounded-lg text-sm" value="youtube_analyzer_export"/>
        </div>

        <div class="muted text-xs mt-4">
          * 로컬(file://)에서도 다운로드는 가능합니다. (브라우저 다운로드 정책에 따라 경로 선택/권한이 필요할 수 있음)
        </div>
      </div>
    </div>

  </div>
</div>

<!-- Modal -->
<div id="modalBackdrop" class="modal-backdrop"></div>
<div id="modal" class="modal panel rounded-2xl p-4">
  <div class="flex items-center justify-between gap-3">
    <div class="text-sm font-semibold">영상 상세</div>
    <button id="btnCloseModal" class="btn px-3 py-2 rounded-lg text-sm">닫기</button>
  </div>
  <div id="modalBody" class="mt-3 text-sm"></div>
</div>

<!-- Toast -->
<div id="toast" class="toast"></div>

<script defer src="./app.js"></script>
</body>
</html>
